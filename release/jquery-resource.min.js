/*!
 * jquery-resource v0.0.0 - Support for RESTful.
 * Copyright 2015 Hironobu Igawa
 * license MIT
 */
var resource;!function(e){"use strict";var t=function(){function e(){}return e.execute=function(t){for(var r=$.extend({},t),n=$.Deferred().resolve(r).promise(),o=0;o<e.interceptors.length;o++)n=n.then(e.interceptors[o].request,e.interceptors[o].requestError);n=n.then(function(e){return e.dataType="json",e.type=e.method,delete e.method,$.ajax(e)});for(var u=e.interceptors.length-1;u>=0;u--)n=n.then(e.interceptors[u].response,e.interceptors[u].responseError);return n},e.interceptors=[],e}();e.Http=t}(resource||(resource={}));var resource;!function(e){"use strict";var t=function(){function t(e,r,n){this.url=r,this.modelClass=function(t){var r=this;e.call(this,t),t&&Object.keys(t).forEach(function(e){t.hasOwnProperty(e)&&(r[e]=t[e])})},this.modelClass.prototype=Object.create(e.prototype),this.actions=$.extend({},t.defaultActions,n)}return t.init=function(e,r,n){var o=new t(e,r,n);return o.initConstructor(),o.initActions(),o.initToJSON(),o.modelClass},t.prototype.initConstructor=function(){var e=this;Object.defineProperty(this.modelClass,"constructor",{value:function(t){return e.generateModel(t)},enumerable:!1,writable:!0,configurable:!0})},t.prototype.initActions=function(){var e=this,t=this.modelClass.prototype;$.each(this.actions,function(r){var n=e.generateAction(r);e.modelClass[r]=function(e){return n(null,e)},t[r]=function(e){return n(this,e)}})},t.prototype.initToJSON=function(){var e=this.modelClass.prototype;e.toJSON=e.defaultToJSON||t.defaultToJSON},t.prototype.copy=function(e,t){t&&$.each(t,function(e){t.hasOwnProperty(e)&&"promise"!==e&&"resolved"!==e&&delete t[e]});var r=t||this.generateModel();return $.each(e,function(e,t){return r[e]=t}),r},t.prototype.generateAction=function(t){var r=this,n=this.actions[t];return function(t,o){var u=!!t,c=u?t:n.arrayFlg?[]:r.generateModel(),i=e.Http.execute(r.generateHttpConfig(n,t,o)).done(function(e){n.arrayFlg?e.forEach(function(e){return c.push(r.generateModel(e))}):r.copy(e,c)}).always(function(){u||(c.resolved=!0)}).then(function(){return c});return u?i:(c.promise=i,c.resolved=!1,c)}},t.prototype.generateHttpConfig=function(t,r,n){var o={};$.each(t,function(e,t){"url"!==e&&"arrayFlg"!==e&&(o[e]=t)});var u=t.url||this.url,c=$.extend({},t.params,r&&r.toJSON(),n),i=e.Router.getURLParamKeys(u);return o.url=e.Router.generateURL(u,i,c),o.data=this.excludeParams(c,i),o},t.prototype.excludeParams=function(e,t){var r=$.extend({},e);return t.forEach(function(e){return delete r[e]}),r},t.prototype.generateModel=function(e){return new this.modelClass(e)},t.defaultActions={get:{method:"GET"},query:{method:"GET",arrayFlg:!0},create:{method:"POST"},update:{method:"PUT"},destroy:{method:"DELETE"}},t.defaultToJSON=function(){var e=this,t={};return Object.keys(this).forEach(function(r){e.hasOwnProperty(r)&&"promise"!==r&&"resolved"!==r&&(t[r]=e[r])}),t},t}();e.Resource=t}(resource||(resource={})),function(e){e.resource={init:resource.Resource.init,http:resource.Http},Object.defineProperty(e.resource,"defaultActions",{get:function(){return resource.Resource.defaultActions},set:function(e){return resource.Resource.defaultActions=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.resource,"defaultToJSON",{get:function(){return resource.Resource.defaultToJSON},set:function(e){return resource.Resource.defaultToJSON=e},enumerable:!0,configurable:!0})}(jQuery);var resource;!function(e){var t=function(){function e(){}return e.getURLParamKeys=function(e){return e.split(/\W/).filter(function(e){return!new RegExp("^\\d+$").test(e)}).filter(function(e){return!!e}).filter(function(t){return new RegExp("(^|[^\\\\]):"+t+"(\\W|$)").test(e)})},e.generateURL=function(t,r,n){if(!r.length)return t;var o=r.reduce(function(t,r){return n[r]?e.replace(t,r,n[r]):e.exclude(t,r)},t);return o.replace(/\/\.json$/,".json")},e.replace=function(t,r,n){return t.replace(new RegExp(":"+r+"(\\W|$)","g"),function(t,r){return e.encodeURI(n)+r})},e.exclude=function(e,t){return e.replace(new RegExp("(/?):"+t+"(\\W|$)","g"),function(e,t,r){return"/"===r.charAt(0)?r:t+r})},e.encodeURI=function(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")},e}();e.Router=t}(resource||(resource={}));